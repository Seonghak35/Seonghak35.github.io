---
layout: post
title: Theoretical Notitions on Numerical Methods for Hyperbolic Equations
date: 2024-01-18
description: This is based on the Computational Modeling for Fluid Dynamics course, which I took at SNU during the summer semester of 2021, by Prof. E.F. Toro.
tags: numerical_method
categories: CFD
giscus_comments: false
related_posts: false
toc:
  sidebar: left
---

## Basic Notion

### General Form

In the previous [post](https://seonghak35.github.io/blog/2024/toro_chap2/), I studied various numerical methods to solve the partial difference equation. These finite difference methods can be written in the general from as follows:

$$
q_i^{n+1}=H\left(q^n_{i-l},q^n_{i-l+1},...,q^n_{i},...,q^n_{i+r}\right),
$$

where $H$ is a real-valued function of $l+r+1$ real variables and depend on the specific numerical method.  For example, Godunov's method is expressed in the general form as follows:

For $\lambda>0$,

$$
H=cq^n_{n-1}+\left(1-c\right)q^n_{i},
$$

For $\lambda<0$,

$$
H=\left(1+c\right)q^n_{n}-cq^n_{i+1}.
$$

### Linear Schemes

Linear schemes are defined as the special class of general form for the linear advection euqation as follows:

$$
q_i^{n+1}=\sum^{k=r}_{k=-l}b_kq^n_{i+k}
$$

where the coefficients $b_k$ are constant (i.e., independent on the solution $q$).

## Local Truncation Error (LTE)

The general form is associated numerical operator as follows:

$$
L_a\left(q^n_i\right)=q_i^{n+1}-H\left(q^n_{i-l},q^n_{i-l+1},...,q^n_{i},...,q^n_{i+r}\right)=0
$$

where $a$ means the 'approximate' and $q^n_i$ is the approximated value. This numerical oprator is different from the differential operator given by

$$
L_e\left(q\right)=\partial_t q+ \lambda\partial_x q=0
$$

where $e$ denotes the 'exact' and $q$ is the exact value.

To evalue error of the numerical operator, the local truncation error (LTE) is defined as

$$
\tau^n_i=\frac{1}{\Delta t}L_a\left(q\left(x_i,t_n\right)\right)
$$

where $\Delta t$ has a role of scaling factor. It is noted that because the numerical operator $L_a$ is applied to the exact solution $q$ evaluated at the mesh point $(x_i,t_n)$, the result is no longer zero.

To calucate the local truncation error, following steps are performed.

+ First of all, it assume that the solution $q(x,t)$ of the PDE is sufficiently smooth (for use of Tayplor expansions).
+ Taylor expansions in space and time about the point $(x_i, t_n)$ give 

$$
\begin{aligned}
\tau^n_i&=\partial_tq\left(i\Delta x,n\Delta t\right)+\lambda \partial_x q\left(i\Delta x,n\Delta t\right) 
\\
&+O(\Delta t^k) + O(\Delta x^m)
\end{aligned}
$$

where $k$ and $m$ are positive integers. The first line is identically same as differential oprator, therfore,remining terms are given by

$$
\tau^n_i=O(\Delta t^k) + O(\Delta x^m)
$$

where the right terms denotes the leading term of $\tau^n_i$. 

### Order of Accuracy

From this expression, the numerical scheme has order of accuray $k$ in time and $m$ in space. When the fixed relationshop between $\Delta x$ and $\Delta t$ is considered, the order of accurcay is defined as 

$$
p=\min\{k,m\}
$$

### Consistnecy

If $\tau_i^n \rightarrow0$ as $\Delta x \rightarrow0$ (or $\Delta t \rightarrow0$), the numerical scheme is said to be consistent with the partial differential equation.


### Example: Godunov Scheme $(\lambda <0)$

To understand the calculation procedure of local truncation error, the Godunov scheme is given by 

$$
H=\left(1+c\right)q^n_{n}-cq^n_{i+1}
$$

Therefore, numerical operator and local truncation error can be expressed by 

$$
\begin{aligned}
L_a\left(q_i^{n}\right)&=q_i^{n+1}-H\\
&=q_i^{n+1}-\left(1+c\right)q^n_{n}+cq^n_{i+1}=0
\end{aligned}
$$

$$
\begin{aligned}
\tau^n_i &= \frac{1}{\Delta t}L_a\left(q\left(x_i,t_n\right)\right) \\
&= \frac{1}{\Delta t}\left[q\left(i\Delta x, (n+1)\Delta t\right)-(1+c)q\left(i\Delta x, \Delta t\right) + cq\left((i+1)\Delta x, n\Delta t\right)\right]
\end{aligned}
$$

by Taylor expansions at the point $\left(x_i, t_n\right)$,

$$
\begin{aligned}
q\left(i\Delta x, (n+1)\Delta t\right) &= q\left(i\Delta x, n\Delta t\right) + \Delta t\partial_t q\left(i\Delta x, n\Delta t\right) \\
&+ \frac{1}{2}\Delta t^2\partial_t^2q\left(i\Delta x, n\Delta t\right) + O(\Delta t^3),
\end{aligned}
$$

$$
\begin{aligned}
q\left((i+1)\Delta x, \Delta t\right) &= q\left(i\Delta x, n\Delta t\right) + \Delta x\partial_x q\left(i\Delta x, n\Delta t\right) \\
&+ \frac{1}{2}\Delta x^2\partial_x^2q\left(i\Delta x, n\Delta t\right) + O(\Delta x^3),
\end{aligned}
$$

Finally, the local truncation error is given by

$$
\begin{aligned}
\tau^n_i&=\frac{1}{\Delta t}[q\left(i\Delta x, n\Delta t\right) + \Delta t\partial_t q\left(i\Delta x, n\Delta t\right) \\
&+ \frac{1}{2}\Delta t^2\partial_t^2q\left(i\Delta x, n\Delta t\right) + O(\Delta t^3) \\
&- (1+c)q\left(i\Delta x, n\Delta t\right) \\
& +c \{ q\left(i\Delta x, n\Delta t\right) + \Delta x\partial_x q\left(i\Delta x, n\Delta t\right) \\
& + \frac{1}{2}\Delta x^2\partial_x^2q\left(i\Delta x, n\Delta t\right) + O(\Delta x^3) \}] \\ \\


&= \partial_t q(i\Delta x, n\Delta t)+\lambda\partial_x q(i\Delta x, n\Delta t) \\
&+ \frac{1}{2}\Delta t \partial_t^2q(i\Delta x, n\Delta t)+\frac{1}{2} \lambda \Delta x \partial_x^2q(i\Delta x, n\Delta t) \\
&+ O(\Delta t^2) + O(\Delta x^2)
\end{aligned}
$$

Because the first term is exact differential equation, this term goes to zero. Then, the leading term of the local truncation error is given by

$$
\tau^n_i=\frac{1}{2}\Delta t \partial_t^2q(i\Delta x, n\Delta t)+\frac{1}{2} \lambda \Delta x \partial_x^2q(i\Delta x, n\Delta t)=O(\Delta t) + O(\delta x)
$$

Therefore, the Godunov scheme is the *first-order accurate* in space in time. Moreover, this equation shows that the local truncation error depend on the mesh parameter $\left(\Delta t, \Delta x\right)$ and due to the derivatives $\left(\partial^2\right)$, the local truncation error increase at the discontinuity region.

Using Cauchy-Kowalewskaya procedure, time derivatives can be convert to space derivatives as follows:

$$
\tau^n_i = \frac{1}{2}\lambda\Delta x \left(1+c\right)\partial_x^2q(i\Delta x, n\Delta t)
$$

where the term of $\partial_x^2q$ means the diffusion term and $\alpha = \frac{1}{2}\lambda\Delta x \left(1+c\right)$ is the diffusion coefficient, which shows that 

+ when $\Delta x$ increase, the diffusion coefficient raise, so the numerical diffusion become severe.
+ due to this numerical diffusion term, the first order method cause the high diffusive solution at the discontinuity region.
+ when $c$ goes to $-1$, the local truncation error decrease, thus the accuracy increase.

## Modified Equation

In the local truncation error equation, 

$$
\begin{aligned}
\tau^n_i
&= \partial_t q(i\Delta x, n\Delta t)+\lambda\partial_x q(i\Delta x, n\Delta t) \\
&+ \frac{1}{2}\Delta t \partial_t^2q(i\Delta x, n\Delta t)+\frac{1}{2} \lambda \Delta x \partial_x^2q(i\Delta x, n\Delta t) \\
&+ O(\Delta t^2) + O(\Delta x^2)
\end{aligned}
$$

Originally, the order of accuracy is first order because the $q(x,t)$ is the solution of the original PDE (here, the first line). However, if the $q(x,t)$ is the solution of the following PDE, more accurate solution can be obtained because the order of accuracy become second order.

$$
\partial_t q+\lambda\partial_x q + \frac{1}{2}\left[\Delta t \partial_t^2q+\lambda \Delta x \partial_x^2q\right] = 0
$$

This equation called the modified equation. Here, if the Cauchy-Kovalevskaya preocedure is applied to the modified equation to convert the second order time derivative to a space derivative, the final form of the modified equation is given by

$$
\partial_t q+\lambda\partial_x q =\alpha\partial_x^2q
$$

where $\alpha=-\frac{1}{2}\lambda\Delta x \left(1+c\right)$ called the coefficient of numerical viscosity. This equation is a second-order PDE of the advection-diffusion type (parabolic), which shows that

+ due to the diffusion term (i.e., numerical viscous term), not physical viscosity, even the solutions of the inviscid equation behave as solutions of a viscous equation.
+ First-order scheme have modified equation that are of the advection-diffusion type with numerical viscosity (second-order)
+ Second-order scheme have modified equation of the dispersion type (third-order) as follows:
  $$
    \partial_t q+\lambda\partial_x q = \gamma \partial_x^3q
  $$
  where $\gamma$ is coefficient of numerical dispersion. this dispersion error show up in the form of phase errors.
  For example, Lax-Wendroff method has this modified equation,
  $$
    \partial_t q+\lambda\partial_x q = \gamma \partial_x^3q;\quad\gamma=\frac{1}{6}\lambda\Delta x^2\left(c^2-1\right).
  $$
  
  Because $\gamma$ depend on the power of grid size, when $\Delta x$ decrease, $\gamma$ rapidly decrease. This means that this scheme has a high convergence speed to exact solution.
  
It is noted that when dealing with physically viscosity situation, both numerical and physical viscosity coexist. Depending on the grid size, numerical viscosity can have higher values than physical viscosity, so it is essential to handle these two terms carefully.

## Linear Stability Analysis

The von Neunamm method for linear stability analysis of a numerical scheme introduces a trial function (i.e., test function) as follows:

$$
q^n_i = A^n\exp\left(I\theta i\right)
$$

where $A$ represent an amplitude, $A^n$ means $A$ raised to the power $n$ (not time notation), the complex unit is denoted by $I\equiv\sqrt{-1}$, $\theta=P\Delta x$ is a phase angle, and $P$ is the wave number in the $x$-direction. 

Representing a numerical solution with a trail function means that as the solution advances in time $(q^n, n\uparrow)$, the amplitude increases $(A^n, n\uparrow)$. Therefore, for stability, the stability condition has to be satisfied as follows:

$$
\vert A \vert \le 1
$$

### Example: Godunov Scheme $(\lambda >0)$

$$
q^{n+1}_i=q^n_i-c\left(q_i^n-q^n_{i-1}\right)
$$

Using these notation,

$$
\begin{aligned}
q^{n+1}_i&=A^{n+1}\exp\left(I\theta i\right) \\
q^n_i &= A^{n}\exp\left(I\theta i\right)\\
q^n_{i-1} &= A^{n}\exp\left(I\theta (i-1)\right),
\end{aligned}
$$

$$
A^{n+1}\exp\left(I\theta i\right)=A^{n}\exp\left(I\theta i\right) - c\left[A^{n}\exp\left(I\theta i\right)-A^{n}\exp\left(I\theta (i-1)\right)\right]
$$

After cancelling $A^{n}\exp\left(I\theta i\right)$ and some mathematical manipulations, the amplitude can be obtained as follows:

$$
\Vert A\Vert^2=(1-c)^2+2c(1-c)cos\theta+c^2
$$

Therefore, by imposing $\Vert A\Vert^2\le 1$, the stable condition for the Godunov scheme is given by $c\le0\le1$. 

### Time Step

