<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Second-Order Non-linear Methods for Scalar Equations | SeongHak KIM</title> <meta name="author" content="SeongHak KIM"> <meta name="description" content="This is based on the Computational Modeling for Fluid Dynamics course, which I took at SNU during the summer semester of 2021, by Prof. E.F. Toro."> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%98%98%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://seonghak35.github.io/blog/2024/toro_chap4/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">SeongHak </span>KIM</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">SeongHak</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Second-Order Non-linear Methods for Scalar Equations</h1> <p class="post-meta">February 17, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/numerical-method"> <i class="fa-solid fa-hashtag fa-sm"></i> numerical_method</a>     ·   <a href="/blog/category/cfd"> <i class="fa-solid fa-tag fa-sm"></i> CFD</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>Godunov’s theorem</strong> says that there are no linear schemes for the linear advection equation of accuracy two or higher. Thus, <strong><em>for oscillation-free and high-order of accuracy, the numerical scheme have to be non-linear method.</em></strong></p> <p>Let’s consider the initial-boundary value problem (IBVP) for the inhomogeneous \((s(q)\neq0)\) and non-linear hyperbolic equation as follows:</p> \[\partial_{t}q+\partial_{x}f(q)=s(q)\] <p>where initial and boundary conditions are given by</p> \[q(x, 0)=q^{(0)}(x),\] \[q(a, t) = b_{L}(t),\] \[q(b,t)=b_{R}(t).\] <h2 id="finite-volume-framework">Finite Volume Framework</h2> <p>Entire space domain \([a,b]\) is discretized into \(M\) cells having interval \(I_i=[x_{x-1/2},x_{x+1/2}]\), which is not a point defined as finite difference framework. The control volume is established as rectangular \(V=[x_{i-1/2}, x_{i+1/2}]\times[t_{n}, t_{n+1}]\).</p> <p>Therefore, <strong><em>exact</em></strong> integration of the partial difference equation (PDE) on control volume is as follows:</p> \[\hat{q}^{n+1}_{i}=\hat{q}^{n}_{i}-\frac{\Delta t}{\Delta x}\left[\hat{f}_{i+1/2}-\hat{f}_{i-1/2}\right] + \Delta t \hat{s}_{i}\] \[\hat{q}^{n}_{i}=\frac{1}{\Delta x}\int_{x_{i-1/2}}^{x_{i+1/2}}q(x,t_n)dx,\] \[\hat{f}_{i+1/2}=\frac{1}{\Delta t}\int_{t_n}^{t_{n+1}}f\left(q(x_{i+1/2},t)\right)dt,\] \[\hat{s}_{i} =\frac{1}{\Delta t}\frac{1}{\Delta x}\int^{t_{n+1}}_{t_{n}}\int^{x_{i+1/2}}_{x_{i-1/2}}s\left(q(x,t)\right)dx dt.\] <p>Here, \(\hat{}\) means the exact value. As mentioned, these value is not defined as point value, but interval. Thus integral average is used for representative value. This equation shows the finite volume framework is one of the conservative form.</p> <p>By removing the hat \((\hat{})\), the <strong><em>approximate</em></strong> finite volume method is given by</p> \[{q}^{n+1}_{i}={q}^{n}_{i}-\frac{\Delta t}{\Delta x}\left[{f}_{i+1/2}-{f}_{i-1/2}\right] + \Delta t {s}_{i},\] <p>where the approximated, numerical flux \((f_{i+1/2})\) and approximated, numerical source \((s_i)\) have to be defined to fully determine a finite volume method. The accuracy of this numerical scheme depends crucially on the accuracy used to approximate the integrals.</p> <h2 id="reconstruction">Reconstruction</h2> <p>The integration of the value make the constant value, and thus remove some distribution of the original value in the interval. To recovering the removed information, the reconstruction can be used. The first-degree polynomial in cell \(i\) is defined as</p> \[p_i(x)=q^{n}_{i}+(x-x_i)\Delta_i,\] <p>where \(x\in[x_{i-1/2}, x_{i+1/2}]\) and \(\Delta_{i}\) is the slope. One of the simple slope is centred slope given by</p> \[\Delta_{i}=\frac{q^{n}_{i+1}-q^{n}_{i-1}}{2\Delta x}.\] <p>With this centred slope, the reconstruction becomes a linear reconstruction as it is <em>fixed</em> (same pattern) for all \(i\), making the solutions oscillatory. On the other hand, by choosing \(\Delta_i\) depending on the solution \((q)\) adaptively, the reconstruction becomes non-linear.</p> <h3 id="procedure-for-numerical-flux">Procedure for Numerical Flux</h3> <p>Boundary values of the cell \([x_{i-1/2}, x_{x+1/2}]\) are as follows:</p> \[q^{L}_{i}=p_i\left(x_{x-1/2}\right)=q^{n}_{i}-\frac{1}{2}\Delta x\Delta_i,\] \[q^{R}_{i}=p_i\left(x_{x+1/2}\right)=q^{n}_{i}+\frac{1}{2}\Delta x\Delta_i.\] <p>For time evolution, taylor expansions are applied, i.e.,</p> \[\hat{q}^{L}_{i}=q^{L}_{i}+\frac{1}{2}\Delta t\partial_t q^L_i,\] \[\hat{q}^{R}_{i}=q^{R}_{i}+\frac{1}{2}\Delta t\partial_t q^R_i.\] <p>To invert time derivative into space derivative, Cauchy-Kowalevskaya procedure is used, i.e.,</p> \[\partial_t q=-\partial_x f(q) + s(q),\] <p>where the flux derivative is approximated as</p> \[\partial_x f(q)\approx\frac{f(q^R_i)-f(q^L_i)}{\Delta x}\equiv\Delta f_i,\] <p>and the source term \(s(q)\) can be obtained by simply substitution of boundary values \(q^L_i\) and \(q^R_i\).</p> <p>Final evolved boundary values become</p> \[\hat{q}^{L}_{i}=q^{L}_{i}-\frac{1}{2}\Delta t\Delta f_i+\frac{1}{2}\Delta ts(q^L_i),\] \[\hat{q}^{R}_{i}=q^{R}_{i}-\frac{1}{2}\Delta t\Delta f_i+\frac{1}{2}\Delta ts(q^R_i).\] <p>The <strong>conventional Riemann problem</strong> can be solved for solution at the local interface \(q_{i+1/2}(0)\) with Centred flux (Riemann problem-free method) or Godunov flux (Riemann solution) using two boundary values as</p> <p>if \(x&lt;0\),</p> \[q(x,0)=h(x)=\hat{q}^R_i\] <p>else if \(x&gt;0\),</p> \[q(x,0)=h(x)=\hat{q}^L_{i+1},\] <p>It is worth noting that these two fluxes are first-order methods when without reconstruction; however, they become second-order methods with reconstruction.</p> <p>Finally, the numerical flux can be obtained by</p> \[f_{i+1/2}=\frac{1}{\Delta t}\int^{t_{n+1}}_{t_{n}}f\left(q\left(x_{i+1/2},\frac{1}{2}\Delta t\right)\right)dt =f\left(q_{i+1/2}(0)\right).\] <h4 id="centred-flux-force">Centred Flux (FORCE)</h4> <p>One of the centred flux is FORCE, which expressed by</p> \[f_{i+1/2}=\frac{1}{\Delta t}\int^{t_{n+1}}_{t_n}f^\mathrm{force}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)dt=f^\mathrm{force}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)\] \[f^\mathrm{force}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)=\frac{1}{2}\left[f^\mathrm{LF}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)+f^\mathrm{LW}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)\right]\] \[f^\mathrm{LF}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)=\frac{1}{2}\left(f\left(\hat{q}^R_i\right)+f\left(\hat{q}^L_{i+1}\right)\right)-\frac{1}{2}\frac{\Delta x}{\Delta t}\left(\hat{q}^L_{i+1}-\hat{q}^R_i\right)\] \[q^\mathrm{LW}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)=\frac{1}{2}\left(\hat{q}^R_i+\hat{q}^L_{i+1}\right)-\frac{1}{2}\frac{\Delta t}{\Delta x}\left(f\left(\hat{q}^L_{i+1}\right)-f\left(\hat{q}^R_{i}\right) \right)\] \[f^\mathrm{LW}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)=f\left(q^\mathrm{LW}_{i+1/2}\left(\hat{q}^R_i,\hat{q}^L_{i+1}\right)\right)\] <h4 id="godunov-flux-upwind-flux">Godunov Flux (Upwind Flux)</h4> <p>If the conventional Riemann problem is applied for linear advection equation, the solution and numerical flux are respectively given by</p> <p>if \(\lambda &gt; 0\),</p> \[q(x_{i+1/2}, t)=\hat{q}^R_i\] \[f_{i+1/2}=\lambda \hat{q}^R_i\] <p>else if \(\lambda &lt; 0\),</p> \[q(x_{i+1/2}, t)=\hat{q}^L_{i+1}\] \[f_{i+1/2}=\lambda \hat{q}^L_{i+1}\] <h3 id="procedure-for-numerical-source">Procedure for Numerical Source</h3> <p>To approximate the volume integral of source term, mid-point rule in space and time is applied with Taylor expansion as follows:</p> \[q\left(x_i, t_n+\frac{1}{2}\Delta t\right)=q^n_i+\frac{1}{2}\Delta t\partial_tq\left(x_i, t_n\right)\] <p>To change the time derivative into space derivative, the Cauchy Kowaleswkaya is used as</p> \[q\left(x_i,t_n+\frac{1}{2}\Delta t\right)=q^n_i-\frac{1}{2}\Delta t\Delta f_i+\frac{1}{2}\Delta ts\left(q^n_i\right)\] <p>Finally, the numerical source is</p> \[s_i=s\left[q^n_i-\frac{1}{2}\Delta t\Delta f_i+\frac{1}{2}\Delta ts\left(q^n_i\right)\right]\] <p>It is worth noting that the equation for numerical flux includes the source term and the equation for numerical source also includes the flux term. Therefore, flux and source terms make a interaction each other, so have to addressed together, not separately.</p> <h2 id="non-linear-schemes">Non-Linear schemes</h2> <h3 id="tvd-slope">TVD slope</h3> <p>With left and right polynomial slopes,</p> \[\Delta_{i-1/2}=\frac{q^n_i - q^n_{i-1}}{\Delta x}\] \[\Delta_{i+1/2}=\frac{q^n_{i+1} - q^n_{i}}{\Delta x}\] <p>The TVD slope (minmod slope) is given by</p> \[\Delta _i =\mathrm{minmod}\left(\Delta_{i-1/2},\Delta_{i+1/2}\right)\] <p>where \(\mathrm{minmod}\) function means that if signs of left and right slopes are same, the slope becomes smaller absolute value between the left and right slopes; however, if the signs are different, the value is zero.</p> <h3 id="eno-slope">ENO slope</h3> <p>The ENO means Essentially Non Oscillatory. This is the same as minmod slope except for not considering the different signs. In other words, ENO considers only smaller absolute value.</p> </div> </article> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 SeongHak KIM. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QZ6W7M2HLM"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QZ6W7M2HLM");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>